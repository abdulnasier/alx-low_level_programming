more functions and nestd loops
